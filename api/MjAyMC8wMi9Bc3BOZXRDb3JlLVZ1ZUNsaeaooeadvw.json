{"title":"AspNetCore+VueCli模板","date":"2020-02-28T22:46:06.000Z","date_formatted":{"ll":"Feb 28, 2020","L":"02/28/2020","MM-DD":"02-28"},"link":"2020/02/AspNetCore-VueCli模板","comments":true,"tags":["AspNetCore","Vue"],"categories":["AspNetCore","笔记"],"updated":"2020-02-28T15:00:13.797Z","content":"<h2 id=\"摘要\">摘要<a href=\"#摘要\" title=\"摘要\"></a></h2><p>AspNetCore一直以来都有前端框架的Spa开发模板。AspNetCore 2.0时，Vue，React，Angular这三大前端框架都有相应的Spa开发模板。但是到了AspNetCore 3.0之后，微软改变了实现方式，理由是这三大框架各自有自己的Cli，原来的实现方式已经没有必要了。于是三个Spa开发模板就剩了两个(React,Angular)。然而剩下的Vue正是我需要的，但是它没有…</p>\n<h2 id=\"angular和react的集成\">Angular和React的集成<a href=\"#angular和react的集成\" title=\"Angular和React的集成\"></a></h2><p>前阵子尝试从Github上了解React和Angular上的集成实现。发现在启动AspNetCore服务的同时运行它们的Cli,并且AspNetCore会将请求代理到前端的开发服务器。这么看来的话，Vue的集成开发模板应该也可以这样实现。毕竟Vue也有自己的Cli。无奈对webpack的配置一直云里雾里的。幸运的是，今天无意中发现了一篇博客 <a href=\"https://www.dotnetcurry.com/aspnet-core/1500/aspnet-core-vuejs-template\" target=\"_blank\">ASP.NET Core Vue CLI Templates</a>。正好讲的是VueCli和AspNetCore 3.0的Spa开发模板的实现。于是乎尝试了一番。</p>\n<h2 id=\"aspnet-core-vue-cli-templates\"><a href=\"https://www.dotnetcurry.com/aspnet-core/1500/aspnet-core-vuejs-template\" target=\"_blank\">ASP.NET Core Vue CLI Templates</a><a href=\"#aspnet-core-vue-cli-templates\" title=\"ASP.NET Core Vue CLI Templates\"></a></h2><p>博客中有提到三种vue和AspNetCore的搭配的方法。</p>\n<ol><li><p>前后端分别独立的开发方式<br>适合多个人的团队，分别开发前端和后端</p></li><li><p>AspNetCore官方模板中的方法<br>将vue开发服务器作为AspNetCore的一个子进程运行，并让AspNetCore作为代理服务器。</p></li><li><p>将AspNetCore官方模板中的方法反转一下<br>将vue开发服务器作代理使用，AspNetCore服务器不作为代理服务器</p></li></ol><h2 id=\"模板搭建\">模板搭建<a href=\"#模板搭建\" title=\"模板搭建\"></a></h2><p>这里尝试的是第三种方法，使用vue开发服务器作代理。</p>\n<h3 id=\"环境\">环境<a href=\"#环境\" title=\"环境\"></a></h3><p>自己的测试环境:</p>\n<ul><li>AspNetCore 3.1.2</li><li>visual code</li><li>@vue/cli 4.2.2</li><li>vue包管理工具yarn</li><li>在webapi模板上更改</li></ul><p><a href=\"https://www.dotnetcurry.com/aspnet-core/1500/aspnet-core-vuejs-template\" target=\"_blank\">ASP.NET Core Vue CLI Templates</a> 中的环境</p>\n<ul><li>AspNetCore 3.0</li><li>visual code/visual studio</li><li>vue包管理工具yarn</li><li>在自带的react spa模板上更改</li></ul><p>这里使用的webapi模板搭建的,包管理工具也改成了yarn。和博客中的介绍大同小异。区别是:我觉得,有助于理解👌。</p>\n<h3 id=\"创建webapi模板和vue模板\">创建webapi模板和vue模板<a href=\"#创建webapi模板和vue模板\" title=\"创建webapi模板和vue模板\"></a></h3><h4 id=\"创建webapi模板\">创建webapi模板<a href=\"#创建webapi模板\" title=\"创建webapi模板\"></a></h4><pre><code>创建模板并添加SpaServices扩展\n\n<figure class=\"highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dotnet new webapi -o AspNetCoreVueCliTemplate</span><br><span class=\"line\"><span class=\"built_in\">cd</span> AspNetCoreVueCliTemplate</span><br><span class=\"line\">dotnet add package <span class=\"built_in\">cd</span> Microsoft.AspNetCore.SpaServices.Extensions --version <span class=\"number\">3</span>.<span class=\"number\">1</span>.<span class=\"number\">2</span></span><br></pre></td></tr></table></figure></code></pre><h4 id=\"创建vue模板\">创建vue模板<a href=\"#创建vue模板\" title=\"创建vue模板\"></a></h4><pre><code>在项目目录下创建vue模板\n\n<figure class=\"highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vue create clientapp</span><br></pre></td></tr></table></figure>\n\nvue创建过程中,按照提示一步步来，包管理工具选择yarn,使用npm也没有关系</code></pre><h4 id=\"添加中间件vuedevelopmentservermiddleware\">添加中间件VueDevelopmentServerMiddleware<a href=\"#添加中间件vuedevelopmentservermiddleware\" title=\"添加中间件VueDevelopmentServerMiddleware\"></a></h4><ol><li>从<a href=\"https://github.com/DaniJG/ASPCoreVueCLITemplates/tree/master/alternative-spa-template\" target=\"_blank\">GitHub</a>将Middleware中的内容全部搬运到自己项目下(包括文件夹)。完成后项目结构如下：</li></ol><p><img src=\"https://u62pgq.bn.files.1drv.com/y4m9xxeXTdO0Y2y9rzTERsEMgQjL621_95Qls6cpi_k-GrxattPp-WDtJ0-Gpph8K_VZNg9hVzMEBeH6mRX_RF2jJOyc9WOe12O4xCR3L2mxxt4qe5UJIW189YluXf2q_YcpLp5eNqVoyjZOzxn53HIuy1eXWCwXh79GUQGfp3b9swU-1EQRBibKAFL3Xj8r2yyKKggc1t_byQVtNNOHWufJg\" class=\"φcy\" alt=\"middleware\"></p>\n<pre><code>YarnScriptRunner是NpmScriptRunner改的</code></pre><ol><li><p>修改项目使用的包管理工具配置npm-&gt;yarn<br><em>使用npm的跳过。</em></p><ul><li><p><strong>将NpmScriptRunner.cs中有关使用npm执行的命令全部换成yarn</strong>。</p></li><li><p><strong>修改AspNetCoreVueCliTemplate.csproj</strong>中的配置<br>主要添加初始环境配置,修改后如下:</p></li><li><p>还有就是Startup.cs<br>主要是添加修改vue的中间件、静态文件处理程序、以及路由。修改后如下:</p></li></ul></li><li><p>配置webpack,为vue服务器设置代理</p></li></ol><h2 id=\"调试\">调试<a href=\"#调试\" title=\"调试\"></a></h2><p><strong>visual code vue脚本调试</strong> 要添加 Debug for Chrome 插件，并配置Launch.json中的启动参数:<br>新增 <strong>Launch Chrome</strong> 和 <strong>.NETCore Launch (console)</strong> (将浏览器启动禁用)两个启动项，并添加 <strong>.Net+Browser</strong> 启动选项(<em>同时启动.NET Core Launch (console)和Launch Chrome</em>)</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"comment\">// Use IntelliSense to find out which attributes exist for C# debugging</span></span><br><span class=\"line\">  <span class=\"comment\">// Use hover for the description of the existing attributes</span></span><br><span class=\"line\">  <span class=\"comment\">// For further information visit https://github.com/OmniSharp/omnisharp-vscode/blob/master/debugger-launchjson.md</span></span><br><span class=\"line\">  <span class=\"attr\">\"version\"</span>: <span class=\"string\">\"0.2.0\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"compounds\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"name\"</span>: <span class=\"string\">\".Net+Browser\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"configurations\"</span>: [ <span class=\"string\">\".NET Core Launch (console)\"</span>, <span class=\"string\">\"Launch Chrome\"</span> ]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"attr\">\"configurations\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"name\"</span>: <span class=\"string\">\".NET Core Launch (console)\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"type\"</span>: <span class=\"string\">\"coreclr\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"request\"</span>: <span class=\"string\">\"launch\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"preLaunchTask\"</span>: <span class=\"string\">\"build\"</span>,</span><br><span class=\"line\">        <span class=\"comment\">// If you have changed target frameworks, make sure to update the program path.</span></span><br><span class=\"line\">        <span class=\"attr\">\"program\"</span>: <span class=\"string\">\"$&#123;workspaceFolder&#125;/bin/Debug/netcoreapp3.1/AspNetCoreVueCliTemplate.dll\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"args\"</span>: [],</span><br><span class=\"line\">        <span class=\"attr\">\"cwd\"</span>: <span class=\"string\">\"$&#123;workspaceFolder&#125;\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"stopAtEntry\"</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"launchBrowser\"</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">\"enabled\"</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"attr\">\"env\"</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">\"ASPNETCORE_ENVIRONMENT\"</span>: <span class=\"string\">\"Development\"</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"attr\">\"sourceFileMap\"</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">\"/Views\"</span>: <span class=\"string\">\"$&#123;workspaceFolder&#125;/Views\"</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"name\"</span>: <span class=\"string\">\"Launch Chrome\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"request\"</span>: <span class=\"string\">\"launch\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"type\"</span>: <span class=\"string\">\"chrome\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"url\"</span>: <span class=\"string\">\"http://localhost:5000\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"webRoot\"</span>: <span class=\"string\">\"$&#123;workspaceFolder&#125;/clientapp/src\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"sourceMaps\"</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"name\"</span>: <span class=\"string\">\".NET Core Launch (web)\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"type\"</span>: <span class=\"string\">\"coreclr\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"request\"</span>: <span class=\"string\">\"launch\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"preLaunchTask\"</span>: <span class=\"string\">\"build\"</span>,</span><br><span class=\"line\">        <span class=\"comment\">// If you have changed target frameworks, make sure to update the program path.</span></span><br><span class=\"line\">        <span class=\"attr\">\"program\"</span>: <span class=\"string\">\"$&#123;workspaceFolder&#125;/bin/Debug/netcoreapp3.1/AspNetCoreVueCliTemplate.dll\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"args\"</span>: [],</span><br><span class=\"line\">        <span class=\"attr\">\"cwd\"</span>: <span class=\"string\">\"$&#123;workspaceFolder&#125;\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"stopAtEntry\"</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        <span class=\"comment\">// Enable launching a web browser when ASP.NET Core starts. For more information: https://aka.ms/VSCode-CS-LaunchJson-WebBrowser</span></span><br><span class=\"line\">        <span class=\"attr\">\"serverReadyAction\"</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">\"action\"</span>: <span class=\"string\">\"openExternally\"</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"pattern\"</span>: <span class=\"string\">\"^\\\\s*Now listening on:\\\\s+(https?://\\\\S+)\"</span>                </span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"attr\">\"env\"</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">\"ASPNETCORE_ENVIRONMENT\"</span>: <span class=\"string\">\"Development\"</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"attr\">\"sourceFileMap\"</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">\"/Views\"</span>: <span class=\"string\">\"$&#123;workspaceFolder&#125;/Views\"</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"name\"</span>: <span class=\"string\">\".NET Core Attach\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"type\"</span>: <span class=\"string\">\"coreclr\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"request\"</span>: <span class=\"string\">\"attach\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"processId\"</span>: <span class=\"string\">\"$&#123;command:pickProcess&#125;\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>这样设置后，vs code调试窗口就会出现 <strong>.Net+Browser</strong> 选项.启动后就可以正常开发调试了。</p>\n<h2 id=\"结束\">结束<a href=\"#结束\" title=\"结束\"></a></h2><p>主要就是这几部分。这样就可以实现AspNetCore和vue的集成了。关于AspNetCore 和 Vue 都还处于入门阶段。很多观念较为模糊。希望能坚持研究下去，即使仅仅作为一个.net 爱好者。</p>\n<p>以上。</p>\n","next":{"title":"顶点的坐标空间变换","link":"2020/02/顶点的坐标空间变换"},"plink":"https://vrjure.github.io/2020/02/AspNetCore-VueCli模板/","toc":[{"id":"摘要","title":"摘要","index":"1"},{"id":"angular和react的集成","title":"Angular和React的集成","index":"2"},{"id":"aspnet-core-vue-cli-templates","title":"ASP.NET Core Vue CLI Templates","index":"3"},{"id":"模板搭建","title":"模板搭建","index":"4","children":[{"id":"环境","title":"环境","index":"4.1"},{"id":"创建webapi模板和vue模板","title":"创建webapi模板和vue模板","index":"4.2"}]},{"id":"调试","title":"调试","index":"5"},{"id":"结束","title":"结束","index":"6"}],"reward":true,"copyright":{"link":"<a href=\"https://vrjure.github.io/2020/02/AspNetCore-VueCli模板/\" title=\"AspNetCore+VueCli模板\">https://vrjure.github.io/2020/02/AspNetCore-VueCli模板/</a>","license":"Attribution-NonCommercial-NoDerivatives 4.0 International (<a href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/\" rel=\"external nofollow\" target=\"_blank\">CC BY-NC-ND 4.0</a>)"}}